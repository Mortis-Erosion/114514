<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>智能聊天系统</title>
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAlWVYSWZNTQAqAAAACAAEAQAAAwAAAAEFJwAAAQEAAwAAAAEElgAAh2kABAAAAAEAAAA+ARIAAwAAAAEAAQAAAAAAAAACkoYAAgAAAA8AAABckggABAAAAAEAAAAAAAAAAE9wbHVzXzE2OTA4Mjg4AAADvElEQVRYCe2XS2sTQRSGHyUhohJBghBpUuLIHtghgUpkNSQPqg6NRNw6cOHCxWfgQrVShfQX/Ai/gQIv4UWrZWs2Kixv01T9qjKoa9n5vL1l3dn95X8nNvrxkLzUIIYQQQvhxq3wLwAwgVdyusx9UBvSDVhWQTlQFKvejlWf8iCeMOypJdFh9cz1kHckm/wWFdn1DE9FcISiqDKcBNRRGdrho3hV1l7GVbNMYJcFiabPSl4G45t45thTLVf6B6B3wGgA4At1utw4bWIhj/0Vq1F7nqwADtDdoFxFzjcU26KDM4z3cNqNd30A5GLP5m6wF6JY5t6RZFlKItAF1hDQqCqUEZEvU4oJcHkF4zQQaL2tsWe8pPeYdMkqKhq6Z2kVJggdBUnVaQbUN4CzoYOg5nd7T7gC8gA3W2u4U6YMrJbHz5SKvhBqVmbEoMZgO9gnzCzRrLBGa8ALXIpn9C9nyJElPlH6uIfrwPsGtlk7YcwCDM/vJwSuWx11jt3RYA91iDqpv+TK5xzOBo64y49k2jQMe07A3HZjFbZ4A+msTKLgRRoYtkixM2VbBiXJSZ3FsAamNImf1gFZ9TIKAZ3KzOIoF6mjAqlUlgqUnbMuTFeuAa7sGlIYZlI3NcdjAqPQWYZFhxSDgCMXGIrj6dgC5KXGFpQkhxKHYSKx4rRkOcFjbQx8RIaTfH6DFIF9XAkxV2V/wB6hBnylUwwYBvmBPo2FxepuM5noEOGaX5R2U7gLNeG8Ox05sIfQ93yPgei8gwDNb+0AtXyq9kgTA2Zd6VGHYIRvAKTEm4uUypT7gTuyNGRDo3yY26Y9Z4WqK+wGS8WkMr7qdifJ9bQPSiE+tUAl5TgqbH/wYmvHoEYXBA1pbgqf3UGa3n1ja6Xnfnok0W3yeiW6OvmKy3OqXjPgvnNkR+FPKfKwbxSWvwAAAABJRU5ErkJggg==" sizes="32x32">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
  <!-- tesseract.js v2/v3/v4 都支持 createWorker；如果用 v5 请确保用对应用法 -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.5/dist/tesseract.min.js"></script>

  <!-- 添加自定义智能体所需的样式 -->
  <style>
    .loader {
      display: none;
      justify-content: center;
      align-items: center;
    }
    .loader span {
      width: 10px;
      height: 10px;
      margin: 0 5px;
      border-radius: 50%;
      background-color: #3498db;
      animation: pulse 1.4s infinite ease-in-out both;
    }
    .loader span:nth-child(1) { animation-delay: -0.32s; }
    .loader span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes pulse {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }
    /* API选择器样式 */
    .api-selector {
      margin-left: 10px;
      display: inline-block;
    }
    #apiSelect {
      padding: 5px 10px;
      border-radius: 4px;
      border: 1px solid #ddd;
      background-color: white;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <!-- 主题切换按钮 -->
  <div class="theme-switcher">
    <button id="defaultTheme" class="theme-btn active" title="默认主题"><i class="fas fa-sun"></i></button>
    <button id="darkTheme" class="theme-btn" title="暗色主题"><i class="fas fa-moon"></i></button>
    <button id="eyeTheme" class="theme-btn" title="护眼主题"><i class="fas fa-leaf"></i></button>
  </div>

  <div class="container" id="accountSystem">
    <div class="header">
      <h1>智能聊天系统</h1>
      <p>安全账号与智能对话</p>
    </div>
    
    <div class="card">
      <div class="tabs">
        <div class="tab active" id="loginTab">账号登录</div>
        <div class="tab" id="registerTab">账号注册</div>
      </div>
      
      <!-- 注册表单 -->
      <div id="registerForm" style="display: none;">
        <div class="info-box">
          <i class="fas fa-info-circle"></i>
          <div>请输入您的邮箱地址作为账号，并设置8位以上安全密码</div>
        </div>
        
        <div class="form-group">
          <label for="registerAccount">邮箱地址</label>
          <div class="input-with-icon">
            <i class="fas fa-envelope"></i>
            <input type="email" id="registerAccount" class="form-control" placeholder="请输入您的邮箱地址" required>
          </div>
        </div>
        
        <div class="form-group">
          <label for="password">设置登录密码</label>
          <div class="input-with-icon">
            <i class="fas fa-lock"></i>
            <input type="password" id="password" class="form-control" placeholder="至少8位字符，包含字母和数字">
          </div>
          <div class="password-strength">
            <div class="strength-meter" id="strengthMeter"></div>
          </div>
          <div class="strength-labels">
            <span class="strength-weak">弱</span>
            <span class="strength-medium">中</span>
            <span class="strength-strong">强</span>
          </div>
        </div>
        
        <div class="form-group">
          <label for="confirmPassword">确认密码</label>
          <div class="input-with-icon">
            <i class="fas fa-lock"></i>
            <input type="password" id="confirmPassword" class="form-control" placeholder="再次输入密码">
          </div>
        </div>
        
        <button id="registerBtn" class="submit-btn">注册账号</button>
      </div>
      
      <!-- 登录表单 -->
      <div id="loginForm">
        <div class="form-group">
          <label for="loginAccount">邮箱地址</label>
          <div class="input-with-icon">
            <i class="fas fa-envelope"></i>
            <input type="email" id="loginAccount" class="form-control" placeholder="输入您的邮箱地址" required>
          </div>
        </div>
        
        <div class="form-group">
          <label for="loginPassword">登录密码</label>
          <div class="input-with-icon">
            <i class="fas fa-lock"></i>
            <input type="password" id="loginPassword" class="form-control" placeholder="输入您的密码">
          </div>
        </div>
        
        <div class="form-group" style="text-align: right;">
          <a href="#" style="color: #2575fc; text-decoration: none;">忘记密码?</a>
        </div>
        
        <button id="loginBtn" class="submit-btn">登录账号</button>
      </div>
    </div>
    
    <div class="footer">
      <p>© 2025 智能聊天系统 | <a href="#">隐私政策</a> | <a href="#">用户协议</a></p>
    </div>
  </div>

  <!-- 聊天页面 -->
  <div id="chatPage">
    <!-- 移除原来的agent-buttons-container -->
    
    <div class="card">
      <div class="header">
        <h1>智能聊天助手</h1>
        <div class="chat-controls">
          <button id="historyBtn" title="历史记录">
            <i class="fas fa-history"></i>
          </button>
          <button id="userInfoBtn" title="账号信息">
            <i class="fas fa-user-circle"></i>
          </button>
          <button id="logoutBtn" title="退出登录">
            <i class="fas fa-sign-out-alt"></i>
          </button>
          <!-- 将自定义智能体按钮移到这里，API选择器的左边 -->
          <button id="newPageBtn4" title="自定义智能体">
            <i class="fas fa-file-code"></i>
            <span>自定义智能体</span>
          </button>
          <!-- 添加API选择器 -->
          <div class="api-selector">
          <select id="apiSelect">
            <option value="deepseek">DeepSeek API</option>
            <option value="volcengine">豆包API</option>
            <option value="kimi">Kimi API</option>
          </select>
        </div>
        </div>
      </div>
      
      <!-- 添加聊天布局容器 -->
      <div class="chat-layout">
        <!-- 左侧历史记录栏 -->
        <div class="history-sidebar">
          <div class="sidebar-header">
            <h3>聊天记录</h3>
            <!-- 添加导出按钮 -->
            <div class="history-export">
              <button id="exportHistoryBtn" class="export-btn-sidebar">
                <i class="fas fa-download"></i> 导出
              </button>
            </div>
            <div class="history-controls-sidebar">
              <input type="text" id="searchInputSidebar" placeholder="搜索记录...">
              <button id="refreshHistoryBtnSidebar" class="refresh-btn-sidebar">
                <i class="fas fa-sync-alt"></i>
              </button>
            </div>
          </div>
          <div id="historyListSidebar" class="history-items"></div>
        </div>
        
        <!-- 右侧聊天主区域 -->
        <div class="chat-main">
          <div id="app">
            <div id="chat">
              <div class="message bot">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAlWVYSWZNTQAqAAAACAAEAQAAAwAAAAEFJwAAAQEAAwAAAAEElgAAh2kABAAAAAEAAAA+ARIAAwAAAAEAAQAAAAAAAAACkoYAAgAAAA8AAABckggABAAAAAEAAAAAAAAAAE9wbHVzXzE2OTA4Mjg4AAADvElEQVRYCe2XS2sTQRSGHyUhohJBghBpUuLIHtghgUpkNSQPqg6NRNw6cOHCxWfgQrVShfQX/Ai/gQIv4UWrZWs2Kixv01T9qjKoa9n5vL1l3dn95X8nNvrxkLzUIIYQQQvhxq3wLwAwgVdyusx9UBvSDVhWQTlQFKvejlWf8iCeMOypJdFh9cz1kHckm/wWFdn1DE9FcISiqDKcBNRRGdrho3hV1l7GVbNMYJcFiabPSl4G45t45thTLVf6B6B3wGgA4At1utw4bWIhj/0Vq1F7nqwADtDdoFxFzjcU26KDM4z3cNqNd30A5GLP5m6wF6JY5t6RZFlKItAF1hDQqCqUEZEvU4oJcHkF4zQQaL2tsWe8pPeYdMkqKhq6Z2kVJggdBUnVaQbUN4CzoYOg5nd7T7gC8gA3W2u4U6YMrJbHz5SKvhBqVmbEoMZgO9gnzCzRrLBGa8ALXIpn9C9nyJElPlH6uIfrwPsGtlk7YcwCDM/vJwSuWx11jt3RYA91iDqpv+TK5xzOBo64y49k2jQMe07A3HZjFbZ4A+msTKLgRRoYtkixM2VbBiXJSZ3FsAamNImf1gFZ9TIKAZ3KzOIoF6mjAqlUlgqUnbMuTFeuAa7sGlIYZlI3NcdjAqPQWYZFhxSDgCMXGIrj6dgC5KXGFpQkhxKHYSKx4rRkOcFjbQx8RIaTfH6DFIF9XAkxV2V/wB6hBnylUwwYBvmBPo2FxepuM5noEOGaX5R2U7gLNeG8Ox05sIfQ93yPgei8gwDNb+0AtXyq9kgTA2Zd6VGHYIRvAKTEm4uUypT7gTuyNGRDo3yY26Y9Z4WqK+wGS8WkMr7qdifJ9bQPSiE+tUAl5TgqbH/wYmvHoEYXBA1pbgqf3UGa3n1ja6Xnfnok0W3yeiW6OvmKy3OqXjPgvnNkR+FPKfKwbxSWvwAAAABJRU5ErkJggg==" alt="机器人头像" class="avatar">
                <div class="message-content">
                  您好！我是您的智能助手，请问有什么可以帮助您的吗？
                </div>
              </div>
            </div>
            <div class="loader" id="loader">
              <span></span>
              <span></span>
              <span></span>
            </div>
            <div class="input-container">
              <textarea id="input" placeholder="请输入您的问题..."></textarea>
              <button id="pauseBtn" title="暂停响应"></button>
              <button id="sendBtn" title="发送"></button>
              <div class="voice-controls">
                <button class="voice-btn" id="startVoice">
                  <i class="fas fa-microphone"></i>
                </button>
                <!-- 添加文件上传按钮 -->
                <button class="voice-btn" id="uploadBtn" title="上传文件">
                  <i class="fas fa-file-upload"></i>
                </button>
                <input type="file" id="fileInput" accept=".txt,.docx,.pdf,.jpg,.jpeg,.png,.gif" style="display: none;" title="选择要上传的文件">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 历史记录模态框 (保持不变，以防需要回退) -->
  <div id="historyModal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h2>对话历史</h2>
      <div class="history-controls">
        <input type="text" id="searchInput" placeholder="输入关键词搜索">
        <button id="refreshHistoryBtn" class="refresh-btn">
          <i class="fas fa-sync-alt"></i> 刷新
        </button>
      </div>
      <div id="historyList"></div>
    </div>
  </div>
  
  <!-- 用户信息模态框 -->
  <div id="userInfoModal" class="modal">
    <div class="modal-content">
      <span class="close-btn close-user-info">&times;</span>
      <h2>用户信息</h2>

      <!-- 个人信息编辑区 - 移到前面 -->
      <div class="user-stats">
        <div class="stat-item">
          <div class="stat-label"><i class="fas fa-user-edit"></i> 用户名</div>
          <input type="text" id="userNameInput" class="stat-value" placeholder="请输入用户名" />
        </div>
        <div class="stat-item">
          <div class="stat-label"><i class="fas fa-envelope"></i> 邮箱</div>
          <div class="stat-value" id="userEmailDisplay"></div>
        </div>
        <div class="stat-item">
          <div class="stat-label"><i class="fas fa-image"></i> 头像</div>
          <div class="stat-value">
            <img id="avatarImg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAlWVYSWZNTQAqAAAACAAEAQAAAwAAAAEFJwAAAQEAAwAAAAEElgAAh2kABAAAAAEAAAA+ARIAAwAAAAEAAQAAAAAAAAACkoYAAgAAAA8AAABckggABAAAAAEAAAAAAAAAAE9wbHVzXzE2OTA4Mjg4AAADvElEQVRYCe2XS2sTQRSGHyUhohJBghBpUuLIHtghgUpkNSQPqg6NRNw6cOHCxWfgQrVShfQX/Ai/gQIv4UWrZWs2Kixv01T9qjKoa9n5vL1l3dn95X8nNvrxkLzUIIYQQQvhxq3wLwAwgVdyusx9UBvSDVhWQTlQFKvejlWf8iCeMOypJdFh9cz1kHckm/wWFdn1DE9FcISiqDKcBNRRGdrho3hV1l7GVbNMYJcFiabPSl4G45t45thTLVf6B6B3wGgA4At1utw4bWIhj/0Vq1F7nqwADtDdoFxFzjcU26KDM4z3cNqNd30A5GLP5m6wF6JY5t6RZFlKItAF1hDQqCqUEZEvU4oJcHkF4zQQaL2tsWe8pPeYdMkqKhq6Z2kVJggdBUnVaQbUN4CzoYOg5nd7T7gC8gA3W2u4U6YMrJbHz5SKvhBqVmbEoMZgO9gnzCzRrLBGa8ALXIpn9C9nyJElPlH6uIfrwPsGtlk7YcwCDM/vJwSuWx11jt3RYA91iDqpv+TK5xzOBo64y49k2jQMe07A3HZjFbZ4A+msTKLgRRoYtkixM2VbBiXJSZ3FsAamNImf1gFZ9TIKAZ3KzOIoF6mjAqlUlgqUnbMuTFeuAa7sGlIYZlI3NcdjAqPQWYZFhxSDgCMXGIrj6dgC5KXGFpQkhxKHYSKx4rRkOcFjbQx8RIaTfH6DFIF9XAkxV2V/wB6hBnylUwwYBvmBPo2FxepuM5noEOGaX5R2U7gLNeG8Ox05sIfQ93yPgei8gwDNb+0AtXyq9kgTA2Zd6VGHYIRvAKTEm4uUypT7gTuyNGRDo3yY26Y9Z4WqK+wGS8WkMr7qdifJ9bQPSiE+tUAl5TgqbH/wYmvHoEYXBA1pbgqf3UGa3n1ja6Xnfnok0W3yeiW6OvmKy3OqXjPgvnNkR+FPKfKwbxSWvwAAAABJRU5ErkJggg==" alt="头像" class="small-avatar" />
            <input type="file" id="avatarUpload" accept="image/*" style="margin-top: 10px;" title="选择头像文件">
          </div>
        </div>
      </div>

      <!-- 统计信息区 - 减小占位 -->
      <div class="info-grid compact">
        <div class="info-card small">
          <i class="fas fa-calendar-alt"></i>
          <div class="info-title">注册时间</div>
          <div class="info-value" id="regDate"></div>
        </div>
        <div class="info-card small">
          <i class="fas fa-comments"></i>
          <div class="info-title">对话数</div>
          <div class="info-value" id="conversationCount"></div>
        </div>
        <div class="info-card small">
          <i class="fas fa-calendar-check"></i>
          <div class="info-title">登录次数</div>
          <div class="info-value" id="activeDays"></div>
        </div>
      </div>

      <button id="saveUserInfoBtn" class="submit-btn" style="margin-top: 30px;">保存</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- 初始化 Supabase 客户端 -->
  <script>
    const SUPABASE_URL = 'https://sfathljcqvsqtazfcohb.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNmYXRobGpjcXZzcXRhemZjb2hiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzNzYxNTAsImV4cCI6MjA2OTk1MjE1MH0.e0h04FnSKOnoPDDVU1LqpgpofT5mJiym1QrB1NFZfQ4';
    
    // 等待Supabase库加载完成后再初始化
    function initSupabase() {
      if (typeof supabase !== 'undefined' && typeof supabase.createClient === 'function') {
        // 全局定义supabase对象
        window.supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY, {
          auth: {
            persistSession: true,
            autoRefreshToken: true,
            detectSessionInUrl: true
          }
        });
        console.log('Supabase client initialized successfully');
      } else {
        console.error('Supabase library not loaded correctly or createClient method not available');
        // 如果初始化失败，稍后重试
        setTimeout(initSupabase, 1000);
      }
    }
    
    // 页面加载完成后初始化Supabase
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initSupabase);
    } else {
      initSupabase();
    }
  </script>
  
  <!-- 3. 然后加载其他依赖Supabase的脚本 -->
  <script src="supabase.js"></script>
  <script src="account.js"></script>
  <script src="chat.js"></script>
  <script src="app.js"></script>
  <script src="reset-password.js"></script>
  <script src="strength-meter.js"></script>
  <script src="theme.js"></script>
  <!-- 引入文档解析库 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>

  <!-- 自定义智能体模态模板 -->
  <template id="customAgentTemplate">
    <div class="custom-agent-root" role="dialog" aria-modal="true">
      <div class="custom-agent-header">
        <button data-role="backBtn" class="btn-back"><i class="fas fa-arrow-left"></i> 返回聊天</button>
        <h2 style="margin:0;">自定义智能体</h2>
        <!-- 可放更多 header 控件 -->
      </div>

      <div class="custom-agent-body" data-role="body">
        <!-- 把 blank2 的聊天主区（#app 内部）HTML 放这里 -->
        <!-- 注意：把所有 id="xxx" 改为 data-role="xxx"（或 class）来避免全局 id 重复 -->
        <div class="chat-layout">
          <!-- 左侧历史记录区 -->
          <div class="history-sidebar">
            <div class="sidebar-header">
              <h3>聊天记录</h3>
              <!-- 添加导出按钮 -->
              <div class="history-export">
                <button data-role="exportHistoryBtn" class="export-btn-sidebar">
                  <i class="fas fa-download"></i> 导出
                </button>
              </div>
              <div class="history-controls-sidebar">
                <input type="text" data-role="searchInputSidebar" placeholder="搜索记录...">
                <button data-role="refreshHistoryBtnSidebar" class="refresh-btn-sidebar">
                  <i class="fas fa-sync-alt"></i>
                </button>
              </div>
            </div>
            <div data-role="historyListSidebar" class="history-items"></div>
          </div>
          
          <!-- 右侧聊天主区域 -->
          <div class="chat-main">
            <div class="agent-panel">
              <div class="agent-title">选择智能体</div>
              <div class="row agent-row">
                <select data-role="agentSelect" class="agent-select"></select>
                <button type="button" class="add-btn agent-add" data-role="addAgentBtn" title="添加智能体">+</button>
                <button type="button" class="add-btn agent-delete" data-role="deleteAgentBtn" title="删除当前智能体" style="margin-left: 6px; background: #ef4444;">
                  <i class="fas fa-trash-alt"></i>
                </button>
                <button type="button" class="add-btn agent-refresh" data-role="refreshAgentBtn" title="刷新智能体列表" style="margin-left: 6px; background: #10b981;">
                  <i class="fas fa-sync-alt"></i>
                </button>
              </div>
            </div>
            
            <div data-role="agentForm" class="agent-form" style="display:none;">
              <div class="form-title">创建新智能体</div>
              <input type="text" data-role="agentName" placeholder="智能体名称">
              <textarea data-role="agentPrompt" placeholder="智能体系统提示词（人格背景设定）"></textarea>
              <div class="row agent-form-actions">
                <button data-role="saveAgentBtn" class="btn-primary">保存</button>
                <button data-role="cancelAgentBtn" class="btn-ghost">取消</button>
              </div>
            </div>
            
            <div data-role="chat" class="custom-agent-chat"></div>
            <div class="custom-agent-input-bar">
              <textarea data-role="input" placeholder="请输入您的问题..."></textarea>
              <button data-role="sendBtn" class="send-btn">
                <span>发送</span>
                <span data-role="loadingIcon" style="display:none;">...</span>
              </button>
            </div>
            <div class="button-container">
              <button data-role="clearBtn" id="clearBtn">清除聊天记录</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 可在 template 中包含局部样式（尽量缩小选择器范围，避免污染全局） -->
    <style>
      .custom-agent-root { background: #ffffff; width:100%; max-width:1100px; margin:0 auto; box-shadow:0 20px 60px rgba(0,0,0,0.18); border-radius:16px; display:flex; flex-direction:column; height:100vh; overflow:hidden; }
      .custom-agent-header { padding:16px 20px; display:flex; align-items:center; gap:12px; border-bottom:1px solid #eef2f7; background: linear-gradient(180deg, #ffffff, #f8fafc); }
      .custom-agent-body { flex:1; overflow:auto; padding:20px; background:#f6f8fb; }
      .btn-back { background:#f1f5f9;border:none;padding:8px 12px;border-radius:10px;cursor:pointer; color:#1f2937; display:inline-flex; align-items:center; gap:6px; }
      .chat-layout { display:grid; grid-template-columns: 320px 1fr; gap:18px; height:100%; }
      .history-sidebar { background:#ffffff; border:1px solid #eef2f7; border-radius:14px; padding:12px; display:flex; flex-direction:column; min-height:0; }
      .history-items { flex:1; overflow:auto; padding-right:6px; }
      .history-controls-sidebar input { border:1px solid #e5e7eb; border-radius:10px; padding:8px 10px; }
      .refresh-btn-sidebar, .export-btn-sidebar { border:none; background:#f1f5f9; border-radius:10px; padding:8px 10px; cursor:pointer; }
      .history-item { background:#f9fafb; border:1px solid #eef2f7; border-radius:10px; padding:10px; transition: all 0.2s ease; }
      .history-item:hover { background:#ffffff; box-shadow:0 6px 16px rgba(15,23,42,0.08); transform: translateY(-1px); }
      .chat-main { background:#ffffff; border:1px solid #eef2f7; border-radius:14px; padding:16px; display:flex; flex-direction:column; min-height:0; }
      .agent-panel { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
      .agent-title { font-weight:600; color:#0f172a; }
      .agent-row { flex:1; }
      .agent-select { width:100%; padding:10px 12px; border:1px solid #e5e7eb; border-radius:10px; background:#fff; }
      .agent-add { width:40px; height:40px; border-radius:10px; border:none; background:#0ea5e9; color:#fff; font-weight:600; cursor:pointer; box-shadow:0 6px 14px rgba(14,165,233,0.25); }
      .agent-form { background:#f8fafc; border:1px solid #e2e8f0; border-radius:12px; padding:12px; margin-bottom:12px; }
      .agent-form input, .agent-form textarea { width:100%; border:1px solid #e5e7eb; border-radius:10px; padding:10px 12px; background:#ffffff; }
      .agent-form textarea { min-height:90px; resize:vertical; }
      .agent-form-actions { justify-content:flex-end; }
      .btn-primary { border:none; background:#2563eb; color:#fff; border-radius:10px; padding:8px 14px; cursor:pointer; }
      .btn-ghost { border:1px solid #e5e7eb; background:#ffffff; color:#0f172a; border-radius:10px; padding:8px 14px; cursor:pointer; }
      .custom-agent-chat { flex:1; overflow:auto; padding:6px 4px 12px; }
      .custom-agent-input-bar { margin-top:auto; position:relative; background:linear-gradient(180deg, rgba(255,255,255,0.9), #ffffff); border-top:1px solid #eef2f7; padding:12px 8px 8px; }
      .custom-agent-input-bar textarea { width:100%; min-height:110px; border:1px solid #e5e7eb; border-radius:14px; padding:12px 56px 36px 14px; resize:vertical; background:#ffffff; }
      .send-btn { position:absolute; right:18px; bottom:20px; border:none; background:linear-gradient(135deg, #3b82f6, #6366f1); color:#fff; padding:10px 14px; border-radius:12px; cursor:pointer; box-shadow:0 10px 24px rgba(59,130,246,0.35); }
      .button-container { margin-top:10px; }
      body.dark-theme .custom-agent-root { background:#0f172a; box-shadow:0 24px 70px rgba(0,0,0,0.35); }
      body.dark-theme .custom-agent-header { background:linear-gradient(180deg, #0f172a, #111827); border-bottom-color:#1f2937; }
      body.dark-theme .custom-agent-body { background:#0b1220; }
      body.dark-theme .chat-main, body.dark-theme .history-sidebar { background:#111827; border-color:#1f2937; }
      body.dark-theme .agent-title, body.dark-theme .custom-agent-header h2 { color:#e5e7eb; }
      body.dark-theme .agent-select, body.dark-theme .agent-form input, body.dark-theme .agent-form textarea, body.dark-theme .custom-agent-input-bar textarea { background:#0b1220; border-color:#1f2937; color:#e5e7eb; }
      body.dark-theme .history-item { background:#0b1220; border-color:#1f2937; }
      body.dark-theme .history-item,
      body.dark-theme .history-item .search-header,
      body.dark-theme .history-item .record-preview,
      body.dark-theme .history-item .user-msg { color:#e5e7eb; }
      body.dark-theme .btn-ghost { background:#0b1220; color:#e5e7eb; border-color:#1f2937; }
      body.dark-theme .btn-back { background:#111827; color:#e5e7eb; }
      body.dark-theme .custom-agent-input-bar { background:linear-gradient(180deg, rgba(15,23,42,0.9), #0f172a); border-top-color:#1f2937; }
      body.eye-theme .custom-agent-root { background:#f6f3e8; }
      body.eye-theme .custom-agent-header { background:linear-gradient(180deg, #f9f6ed, #f3efe4); border-bottom-color:#e6e0d2; }
      body.eye-theme .custom-agent-body { background:#f4f1e8; }
      body.eye-theme .chat-main, body.eye-theme .history-sidebar { background:#fbf8f1; border-color:#e6e0d2; }
      body.eye-theme .agent-select, body.eye-theme .agent-form input, body.eye-theme .agent-form textarea, body.eye-theme .custom-agent-input-bar textarea { background:#fffdf7; border-color:#e6e0d2; }
      body.eye-theme .custom-agent-input-bar { background:linear-gradient(180deg, rgba(251,248,241,0.9), #fbf8f1); border-top-color:#e6e0d2; }
      /* clearBtn 样式 */
      #clearBtn {
        margin-top: 12px;
        background-color: #f8fafc;
        color: #4a5568;
        border: 1px solid #e2e8f0;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        width: 100%;
        padding: 10px;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      #clearBtn:hover {
        background-color: #edf2f7;
        color: #2d3748;
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      }
      
      #clearBtn:active {
        transform: translateY(-1px);
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      }
      /* 其它局部样式... */
    </style>
  </template>

</body>
</html>
